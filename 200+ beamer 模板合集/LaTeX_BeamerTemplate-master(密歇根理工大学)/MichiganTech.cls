%
% MichiganTech.cls
% Do not edit this file unless there is an absolute need, and/or in the
% absence of knowledge of LaTeX class.

% Work to be done:
% Incorporate \finalslidecolor as the text color for \finalslidenote;
% currently, the \finalslidecolor is hard coded as ForestGreen

%
% LaTeX compiler
\NeedsTeXFormat{LaTeX2e}

%
% Class name and a brief description
\ProvidesClass{MichiganTech}[2015/04/22 Presentation Class]

%
% Document class (and options) to load
\LoadClass[aspectratio=43,t]{beamer}
\usetheme{default}

%
% Packages
\RequirePackage{etex}
\RequirePackage{amsfonts}
\RequirePackage{amsmath}
\RequirePackage{amssymb}
\RequirePackage{bohr}
\RequirePackage[small,bf,up]{caption}
\RequirePackage{chessboard}
\RequirePackage{colortbl}
\RequirePackage{enumerate}
\RequirePackage{epsfig}
\RequirePackage{etoolbox}
\RequirePackage{fancybox}
\RequirePackage{fancyhdr}
\RequirePackage{filecontents}
\RequirePackage[hang,flushmargin,multiple]{footmisc}
\RequirePackage{framed}
\RequirePackage{graphicx}
\RequirePackage{lastpage}
\RequirePackage{latexsym}
\RequirePackage{listings}
\RequirePackage{longtable}
\RequirePackage{lscape}
\RequirePackage{makeidx}
\RequirePackage{mathabx}
\RequirePackage{multicol}
\RequirePackage{multirow}
\RequirePackage[square,comma,sort&compress,numbers]{natbib}
\RequirePackage{nextpage}
\RequirePackage{pgffor}
\RequirePackage{pgfplots}
\RequirePackage{pgfplotstable}
\RequirePackage{rotate}
\RequirePackage{rotating}
\RequirePackage{setspace}
\RequirePackage{skak}
\RequirePackage{smartdiagram}
\RequirePackage[bf]{subfigure}
\RequirePackage{tabularx}
\RequirePackage{textcomp}
\RequirePackage[absolute,overlay]{textpos}
\RequirePackage{tikz}
\RequirePackage[normalem]{ulem}
\RequirePackage{upquote}
\RequirePackage{wrapfig}
\RequirePackage{wasysym}
\RequirePackage{xcolor}
\RequirePackage{empheq}
\RequirePackage[theorems,skins]{tcolorbox}
\RequirePackage{url}
\RequirePackage{bookmark}
\RequirePackage{hyperref}
\hypersetup{bookmarksdepth=4,bookmarksnumbered=true,bookmarksopen=true}

\usetikzlibrary{angles,arrows,arrows.meta,calc,chains,decorations,decorations.fractals,decorations.markings,decorations.pathmorphing,decorations.text,fit,fadings,graphs,intersections,lindenmayersystems,matrix,mindmap,patterns,plotmarks,positioning,quotes,shapes,shadings,shadows,svg.path,tikzmark,trees}

% Shape definitions
\tikzstyle{lineverythin} = [draw, very thin]
\tikzstyle{linethin}     = [draw, thin]
\tikzstyle{linethick}    = [draw, thick]
\tikzstyle{sarrowthin}   = [draw, -latex', thin]
\tikzstyle{sarrowthick}  = [draw, -latex', thick]
\tikzstyle{rsarrowthin}  = [draw, latex'-, thin]
\tikzstyle{rsarrowthick} = [draw, latex'-, thick]
\tikzstyle{darrowthin}   = [draw, latex'-latex', thin]
\tikzstyle{darrowthick}  = [draw, latex'-latex', thick]

% Shortcuts
\newcommand{\bq}{\`\!}
\newcommand{\sq}{\textquotesingle}

\hypersetup{pdfstartview={Fit}}
\setbeamertemplate{navigation symbols}{}
\setbeamersize{text margin left=0.25in}
\setbeamersize{text margin right=0.25in}

%
% Graphics type and search path
\graphicspath{{.}{./Figures/}}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

%
% Colors
\definecolor{Black}{HTML}{000000}
\definecolor{Navy}{HTML}{000080}
\definecolor{DarkBlue}{HTML}{00008B}
\definecolor{MediumBlue}{HTML}{0000CD}
\definecolor{Blue}{HTML}{0000FF}
\definecolor{DarkGreen}{HTML}{006400}
\definecolor{Green}{HTML}{008000}
\definecolor{Teal}{HTML}{008080}
\definecolor{DarkCyan}{HTML}{008B8B}
\definecolor{DeepSkyBlue}{HTML}{00BFFF}
\definecolor{DarkTurquoise}{HTML}{00CED1}
\definecolor{MediumSpringGreen}{HTML}{00FA9A}
\definecolor{Lime}{HTML}{00FF00}
\definecolor{SpringGreen}{HTML}{00FF7F}
\definecolor{Aqua}{HTML}{00FFFF}
\definecolor{Cyan}{HTML}{00FFFF}
\definecolor{MidnightBlue}{HTML}{191970}
\definecolor{DodgerBlue}{HTML}{1E90FF}
\definecolor{LightSeaGreen}{HTML}{20B2AA}
\definecolor{ForestGreen}{HTML}{228B22}
\definecolor{SeaGreen}{HTML}{2E8B57}
\definecolor{DarkSlateGray}{HTML}{2F4F4F}
\definecolor{LimeGreen}{HTML}{32CD32}
\definecolor{MediumSeaGreen}{HTML}{3CB371}
\definecolor{Turquoise}{HTML}{40E0D0}
\definecolor{RoyalBlue}{HTML}{4169E1}
\definecolor{SteelBlue}{HTML}{4682B4}
\definecolor{DarkSlateBlue}{HTML}{483D8B}
\definecolor{MediumTurquoise}{HTML}{48D1CC}
\definecolor{Indigo}{HTML}{4B0082}
\definecolor{DarkOliveGreen}{HTML}{556B2F}
\definecolor{CadetBlue}{HTML}{5F9EA0}
\definecolor{CornflowerBlue}{HTML}{6495ED}
\definecolor{MediumAquaMarine}{HTML}{66CDAA}
\definecolor{DimGray}{HTML}{696969}
\definecolor{SlateBlue}{HTML}{6A5ACD}
\definecolor{OliveDrab}{HTML}{6B8E23}
\definecolor{SlateGray}{HTML}{708090}
\definecolor{LightSlateGray}{HTML}{778899}
\definecolor{MediumSlateBlue}{HTML}{7B68EE}
\definecolor{LawnGreen}{HTML}{7CFC00}
\definecolor{Chartreuse}{HTML}{7FFF00}
\definecolor{Aquamarine}{HTML}{7FFFD4}
\definecolor{Maroon}{HTML}{800000}
\definecolor{Purple}{HTML}{800080}
\definecolor{Olive}{HTML}{808000}
\definecolor{Gray}{HTML}{808080}
\definecolor{SkyBlue}{HTML}{87CEEB}
\definecolor{LightSkyBlue}{HTML}{87CEFA}
\definecolor{BlueViolet}{HTML}{8A2BE2}
\definecolor{DarkRed}{HTML}{8B0000}
\definecolor{DarkMagenta}{HTML}{8B008B}
\definecolor{SaddleBrown}{HTML}{8B4513}
\definecolor{DarkSeaGreen}{HTML}{8FBC8F}
\definecolor{LightGreen}{HTML}{90EE90}
\definecolor{MediumPurple}{HTML}{9370DB}
\definecolor{DarkViolet}{HTML}{9400D3}
\definecolor{PaleGreen}{HTML}{98FB98}
\definecolor{DarkOrchid}{HTML}{9932CC}
\definecolor{YellowGreen}{HTML}{9ACD32}
\definecolor{Sienna}{HTML}{A0522D}
\definecolor{Brown}{HTML}{A52A2A}
\definecolor{DarkGray}{HTML}{A9A9A9}
\definecolor{LightBlue}{HTML}{ADD8E6}
\definecolor{GreenYellow}{HTML}{ADFF2F}
\definecolor{PaleTurquoise}{HTML}{AFEEEE}
\definecolor{LightSteelBlue}{HTML}{B0C4DE}
\definecolor{PowderBlue}{HTML}{B0E0E6}
\definecolor{FireBrick}{HTML}{B22222}
\definecolor{DarkGoldenRod}{HTML}{B8860B}
\definecolor{MediumOrchid}{HTML}{BA55D3}
\definecolor{RosyBrown}{HTML}{BC8F8F}
\definecolor{DarkKhaki}{HTML}{BDB76B}
\definecolor{Silver}{HTML}{C0C0C0}
\definecolor{MediumVioletRed}{HTML}{C71585}
\definecolor{IndianRed}{HTML}{CD5C5C}
\definecolor{Peru}{HTML}{CD853F}
\definecolor{Chocolate}{HTML}{D2691E}
\definecolor{Tan}{HTML}{D2B48C}
\definecolor{LightGray}{HTML}{D3D3D3}
\definecolor{Thistle}{HTML}{D8BFD8}
\definecolor{Orchid}{HTML}{DA70D6}
\definecolor{GoldenRod}{HTML}{DAA520}
\definecolor{PaleVioletRed}{HTML}{DB7093}
\definecolor{Crimson}{HTML}{DC143C}
\definecolor{Gainsboro}{HTML}{DCDCDC}
\definecolor{Plum}{HTML}{DDA0DD}
\definecolor{BurlyWood}{HTML}{DEB887}
\definecolor{LightCyan}{HTML}{E0FFFF}
\definecolor{Lavender}{HTML}{E6E6FA}
\definecolor{DarkSalmon}{HTML}{E9967A}
\definecolor{Violet}{HTML}{EE82EE}
\definecolor{PaleGoldenRod}{HTML}{EEE8AA}
\definecolor{LightCoral}{HTML}{F08080}
\definecolor{Khaki}{HTML}{F0E68C}
\definecolor{AliceBlue}{HTML}{F0F8FF}
\definecolor{HoneyDew}{HTML}{F0FFF0}
\definecolor{Azure}{HTML}{F0FFFF}
\definecolor{SandyBrown}{HTML}{F4A460}
\definecolor{Wheat}{HTML}{F5DEB3}
\definecolor{Beige}{HTML}{F5F5DC}
\definecolor{WhiteSmoke}{HTML}{F5F5F5}
\definecolor{MintCream}{HTML}{F5FFFA}
\definecolor{GhostWhite}{HTML}{F8F8FF}
\definecolor{Salmon}{HTML}{FA8072}
\definecolor{AntiqueWhite}{HTML}{FAEBD7}
\definecolor{Linen}{HTML}{FAF0E6}
\definecolor{LightGoldenRodYellow}{HTML}{FAFAD2}
\definecolor{OldLace}{HTML}{FDF5E6}
\definecolor{Red}{HTML}{FF0000}
\definecolor{Fuchsia}{HTML}{FF00FF}
\definecolor{Magenta}{HTML}{FF00FF}
\definecolor{DeepPink}{HTML}{FF1493}
\definecolor{OrangeRed}{HTML}{FF4500}
\definecolor{Tomato}{HTML}{FF6347}
\definecolor{HotPink}{HTML}{FF69B4}
\definecolor{Coral}{HTML}{FF7F50}
\definecolor{DarkOrange}{HTML}{FF8C00}
\definecolor{LightSalmon}{HTML}{FFA07A}
\definecolor{Orange}{HTML}{FFA500}
\definecolor{LightPink}{HTML}{FFB6C1}
\definecolor{Pink}{HTML}{FFC0CB}
\definecolor{Gold}{HTML}{FFD700}
\definecolor{PeachPuff}{HTML}{FFDAB9}
\definecolor{NavajoWhite}{HTML}{FFDEAD}
\definecolor{Moccasin}{HTML}{FFE4B5}
\definecolor{Bisque}{HTML}{FFE4C4}
\definecolor{MistyRose}{HTML}{FFE4E1}
\definecolor{BlanchedAlmond}{HTML}{FFEBCD}
\definecolor{PapayaWhip}{HTML}{FFEFD5}
\definecolor{LavenderBlush}{HTML}{FFF0F5}
\definecolor{SeaShell}{HTML}{FFF5EE}
\definecolor{Cornsilk}{HTML}{FFF8DC}
\definecolor{LemonChiffon}{HTML}{FFFACD}
\definecolor{FloralWhite}{HTML}{FFFAF0}
\definecolor{Snow}{HTML}{FFFAFA}
\definecolor{Yellow}{HTML}{FFFF00}
\definecolor{LightYellow}{HTML}{FFFFE0}
\definecolor{Ivory}{HTML}{FFFFF0}
\definecolor{White}{HTML}{FFFFFF}

%
% Colors coded notations
\newcommand{\puser}[1]{\textcolor{DarkOrchid}{\texttt{#1}}}
\newcommand{\pemail}[1]{\textcolor{DodgerBlue}{\texttt{#1}}}
\newcommand{\pphone}[1]{\textcolor{MediumSlateBlue}{\textsf{#1}}}
\newcommand{\purl}[1]{\textcolor{RoyalBlue}{#1}}
\newcommand{\pmachine}[1]{\textcolor{Olive}{\texttt{#1}}}
\newcommand{\pcode}[1]{\textcolor{Black}{\texttt{#1}}}
\newcommand{\pcomment}[1]{\textcolor{DarkBlue}{\texttt{#1}}}
\newcommand{\pcommand}[1]{\textcolor{DarkSlateGray}{\texttt{#1}}}
\newcommand{\pfunction}[1]{\textcolor{DarkCyan}{\texttt{#1}}}
\newcommand{\pfilename}[1]{\textcolor{ForestGreen}{\texttt{#1}}}

%
% Options for listings
\lstset{
  backgroundcolor=\color{white},
  tabsize=2,
  rulecolor=,
  aboveskip={1.0\baselineskip},
  columns=fixed,
  extendedchars=true,
  breaklines=true,
  prebreak = \raisebox{0ex}[0ex][0ex]{\ensuremath{\hookleftarrow}},
  frame=none,
  basicstyle=\ttfamily\tiny,
  identifierstyle=\color{Olive}\ttfamily,
  keywordstyle=\color{Magenta}\ttfamily,
  commentstyle=\color{MediumBlue}\ttfamily,
  stringstyle=\color{Maroon}\ttfamily,
  showtabs=false,
  showspaces=false,
  showstringspaces=false
}

%
% Text boxes
\setbeamercolor{generalnoteboxhead}{fg=White,bg=Yellow!60!Black}
\setbeamercolor{generalnoteboxbody}{fg=Black,bg=Yellow!5}
\setbeamercolor{definitionboxhead}{fg=White,bg=RoyalBlue!75!Black}
\setbeamercolor{definitionboxbody}{fg=Black,bg=RoyalBlue!5}
\setbeamercolor{triviaboxhead}{fg=White,bg=OliveDrab!75}
\setbeamercolor{triviaboxbody}{fg=Black,bg=OliveDrab!5}
\setbeamercolor{brainstormboxhead}{fg=White,bg=Teal!75!Black}
\setbeamercolor{brainstormboxbody}{fg=Black,bg=Teal!5}
\setbeamercolor{commandboxhead}{fg=White,bg=Gray!25!Black}
\setbeamercolor{commandboxbody}{fg=Black,bg=Gray!5}
\setbeamercolor{reviewboxhead}{fg=White,bg=Violet!50!Black}
\setbeamercolor{reviewboxbody}{fg=Black,bg=Violet!5}
\setbeamercolor{doathomeboxhead}{fg=White,bg=Olive!50}
\setbeamercolor{doathomeboxbody}{fg=Black,bg=Olive!5}
\setbeamercolor{activepartyboxhead}{fg=White,bg=Olive!50}
\setbeamercolor{activepartyboxbody}{fg=Black,bg=Olive!5}
\setbeamercolor{envelopeboxhead}{fg=White,bg=SlateGray!75}
\setbeamercolor{envelopeboxbody}{fg=Black,bg=SlateGray!5}
\setbeamercolor{freetimeboxhead}{fg=White,bg=SlateGray!75}
\setbeamercolor{freetimeboxbody}{fg=Black,bg=SlateGray!5}
\setbeamercolor{warningboxhead}{fg=White,bg=DarkOrange!75!Black}
\setbeamercolor{warningboxbody}{fg=Black,bg=DarkOrange!5}
\setbeamercolor{questionboxhead}{fg=White,bg=FireBrick!75}
\setbeamercolor{questionboxbody}{fg=Black,bg=FireBrick!5}

%
% Footnote (must be the first thing in a frame)
\newenvironment{reference}[3]{% 
  \begin{textblock*}{\textwidth}(#1,#2) 
  \footnotesize\tiny\bgroup\color{#3}}{\egroup\end{textblock*}}

%
% Itemized list settings
\newlength{\wideitemsep}
\setlength{\wideitemsep}{\itemsep}
\addtolength{\wideitemsep}{5pt}
\let\olditem\item
\renewcommand{\item}{\setlength{\itemsep}{\wideitemsep}\olditem}
\setlength{\leftmargini}{1em}
\setlength{\leftmarginii}{1em}
\setlength{\leftmarginiii}{1em}
\setbeamertemplate{enumerate items}[default]
\setbeamertemplate{itemize items}[square]
\setbeamertemplate{itemize item}{\color{black}$\Asterisk$}
\setbeamertemplate{itemize subitem}{\color{darkgray}$\Asterisk$}
\setbeamertemplate{itemize subsubitem}{\color{gray}$\Asterisk$}
\setbeamertemplate{itemize/enumerate subbody begin}{\vspace{5pt}}
\setbeamertemplate{itemize/enumerate subbody end}{\vspace{5pt}}
\setbeamertemplate{itemize/enumerate subsubbody begin}{\vspace{5pt}}
\setbeamertemplate{itemize/enumerate subsubbody end}{\vspace{5pt}}

%
% Colored box around equations
\newcommand{\boxalign}[2][0.50\textwidth]{
 \par\noindent\tikzstyle{mybox} = [draw=DodgerBlue,rounded corners,inner sep=6pt, minimum width=1ex]
 \begin{center}\begin{tikzpicture}
  \node [mybox] (box){%
   \begin{minipage}{#1}{\vspace{-5mm}#2}\end{minipage}
  };
 \end{tikzpicture}\end{center}
}

\renewcommand{\boxed}[2]{\textcolor{#1}{%
  \tikz[baseline={([yshift=-1ex]current bounding box.center)}] \node [rectangle, minimum width=1ex,rounded corners,draw] {\normalcolor\m@th$\displaystyle#2$};}}

%
% Retrieve values for different variables
\def\presentationtitle#1{\gdef\@presentationtitle{#1}}
\def\presentationdate#1{\gdef\@presentationdate{#1}}
\def\presentername#1{\gdef\@presentername{#1}}
\def\presentertitle#1{\gdef\@presentertitle{#1}}
\def\presenterdept#1{\gdef\@presenterdept{#1}}
\def\presenteruniv#1{\gdef\@presenteruniv{#1}}
\def\presenteremail#1{\gdef\@presenteremail{#1}}
\def\presenterphone#1{\gdef\@presenterphone{#1}}
\def\presenterurl#1{\gdef\@presenterurl{#1}}
\def\finalslidenote#1{\gdef\@finalslidenote{#1}}
\def\finalslidecolor#1{\gdef\@finalslidecolor{#1}}

%
% Only on title slide
% Template
\defbeamertemplate*{title page}{MichiganTech}[1][]{
  \centering
    \vskip 75pt
    \usebeamerfont{title}\inserttitle\par
    \bigskip
    \usebeamerfont{institute}\insertinstitute\par
    \vfill
}

% Michigan Tech logo
\setbeamertemplate{footline}{
  \color{gray}
  \rule{\textwidth}{0.10pt}
  \vskip3pt%
  \begin{tabularx}{\textwidth}{XX}
    &
    \hspace*{\fill}\href{http://www.mtu.edu}{\includegraphics[height=0.25in]{MichiganTech}}
  \end{tabularx}
}
% Only on title slide

%
% Title slide
\def\titleslide{
  \title{\expandafter{\@presentationtitle}}
  \author{\expandafter{\@presentername}}
  \institute[Michigan Tech]{
    \vskip 10pt
    {\small \expandafter{\@presentername}}\\
    \vskip 2pt
    \expandafter{\@presentertitle}, \expandafter{\@presenterdept}\\
    \vskip 2pt
    \expandafter{\@presenteruniv}\\
    \vskip 2pt
    \pphone{\expandafter{\@presenterphone}} $\cdot$ \pemail{\expandafter{\@presenteremail}} $\cdot$ \href{\expandafter{\@presenterurl}}{\purl{\expandafter{\@presenterurl}}}
    \vskip 10pt
    {\tiny \expandafter{\@presentationdate}}
  }

  \date{}
}

% Non-title slide
\def\nontitleslidesetup{
  \setbeamertemplate{background}{}
  % Draw a line under the slide title
  \setbeamertemplate{headline}{
    \color{gray}
    \rule{\textwidth}{0.10pt}
    \vskip-30pt%
  }

  % Page number and Michigan Tech logo
  \setbeamertemplate{footline}{
    \color{gray}
    \rule{\textwidth}{0.10pt}
    \vskip3pt%
    \begin{tabularx}{\textwidth}{XX}
      \parbox{0.99\linewidth}{\vspace*{-17.50pt}
        {\tiny \hspace*{0.075in}\expandafter{\@presentername} $\cdot$ Slide \# \insertframenumber\hfill\phantom{.}}} &
      \hspace*{\fill}\href{http://www.mtu.edu}{\includegraphics[height=0.25in]{MichiganTech}}
    \end{tabularx}
  }
}

% Final slide
\def\finalslide{
  \setbeamertemplate{footline}{
    \color{gray}
    \rule{\textwidth}{0.10pt}
    \vskip3pt%
    \begin{tabularx}{\textwidth}{XX}
      &
      \hspace*{\fill}\href{http://www.mtu.edu}{\includegraphics[height=0.25in]{MichiganTech}}
    \end{tabularx}
  }

  \begin{frame}{\;}
    \centering
      \vskip 75pt
      {\Huge \textcolor{ForestGreen}{\expandafter{\@finalslidenote}}}\\
      \vspace{0.10in}
      {\tiny \pphone{\expandafter{\@presenterphone}} $\cdot$ \pemail{\expandafter{\@presenteremail}} $\cdot$ \href{\expandafter{\@presenterurl}}{\purl{\expandafter{\@presenterurl}}}}
  \end{frame}
}
